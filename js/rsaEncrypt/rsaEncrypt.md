# Реализация шифрования RSA

Этот скрипт демонстрирует реализацию алгоритма RSA — асимметричного шифрования, основанного на сложности разложения больших чисел на множители. RSA используется для безопасной передачи данных благодаря публичному и приватному ключам.

---

## Основные этапы работы скрипта

### 1. **Основные математические функции**

1. **`getGcd(a, b)`**  
   Реализует алгоритм Евклида для вычисления наибольшего общего делителя (НОД) двух чисел.

2. **`modInverse(a, m)`**  
   Находит обратное по модулю число для `a` относительно `m`. Используется в процессе генерации приватного ключа.

3. **`isPrime(n)`**  
   Проверяет, является ли число простым.

4. **`modExp(base, exp, mod)`**  
   Выполняет быстрое возведение в степень по модулю. Эта функция критически важна для операций шифрования и расшифровки.

---

### 2. **Генерация ключей RSA**

Функция **`generateKeypair(p, q, keySize)`** отвечает за создание пары ключей: публичного и приватного.

1. **Простые числа `p` и `q`**  
   Для генерации ключей выбираются два больших простых числа.  
   В примере используются фиксированные значения: `p = 61` и `q = 53`.

2. **Модуль `n`**  
   Рассчитывается как произведение `p` и `q`:  
   \[
   n = p \times q
   \]

3. **Функция Эйлера `φ(n)`**  
   Вычисляется как:  
   \[
   φ(n) = (p - 1) \times (q - 1)
   \]

4. **Публичная экспонента `e`**  
   Выбирается случайным образом так, чтобы \(\text{НОД}(e, φ(n)) = 1\).

5. **Приватная экспонента `d`**  
   Вычисляется как обратное по модулю число для `e` относительно `φ(n)`:
   \[
   d \equiv e^{-1} \mod φ(n)
   \]

Результатом работы функции является пара ключей:

-   Публичный ключ: `([e, n])`
-   Приватный ключ: `([d, n])`

---

### 3. **Шифрование и расшифровка**

1. **Шифрование (`encryptMessage`)**  
   Каждая буква сообщения преобразуется в ASCII-код, который возводится в степень `e` и берётся по модулю `n`:
   \[
   c = m^e \mod n
   \]
   Где \(c\) — зашифрованный символ, а \(m\) — числовое представление исходного символа.

2. **Расшифровка (`decryptMessage`)**  
   Для расшифровки используется обратная операция с экспонентой `d`:
   \[
   m = c^d \mod n
   \]
   Полученное значение \(m\) преобразуется обратно в символ ASCII.

---

### 4. **Демонстрация работы**

1. **Инициализация ключей**  
   Используются простые числа `p = 61` и `q = 53`. Публичный и приватный ключи генерируются автоматически:

    ```javascript
    const { publicKey, privateKey } = generateKeypair(
        p,
        q,
        2 ** def_bit_length
    );
    ```

2. **Шифрование сообщения**  
   Пользователь вводит строку для шифрования. Каждый символ преобразуется в зашифрованный текст. Например, для "Hi" результат может выглядеть так:

    ```plaintext
    Сообщение (в кодах символов): 72 105
    Результат работы шифра:
    841 1193
    ```

3. **Расшифровка сообщения**  
   После расшифровки получаем оригинальное сообщение:

    ```plaintext
    Результат дешифровки:
    Hi
    ```

4. **Вывод ключей и результата**  
   Ключи и промежуточные данные выводятся в консоль для наглядности.

---

## Пример работы

1. **Генерация ключей**

    ```plaintext
    Ваш публичный ключ: [17, 3233]
    Ваш приватный ключ: [2753, 3233]
    ```

2. **Шифрование**  
   Вводим сообщение `"Hello"`:

    ```plaintext
    Сообщение (в кодах символов): 72 101 108 108 111
    Результат работы шифра:
    1282 1319 745 745 2182
    ```

3. **Расшифровка**  
   Получаем:
    ```plaintext
    Результат дешифровки:
    Hello
    ```

---

## Заключение

Этот скрипт демонстрирует ключевые этапы работы алгоритма RSA: генерацию ключей, шифрование и расшифровку. Данный метод подходит для безопасной передачи сообщений, где требуется асимметричная криптография.
